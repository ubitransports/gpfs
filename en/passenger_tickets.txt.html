<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPFS Reference</title>

    <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic'
          rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="https://ubitransports.github.io/gpfs/css/theme.css" type="text/css"/>
    <link rel="stylesheet" href="https://ubitransports.github.io/gpfs/css/theme-fixes.css" type="text/css"/>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
</head>
<body class="wy-body-for-nav">

    <div class="wy-grid-for-nav">

        <nav data-toggle="wy-nav-shift" class="wy-nav-side">
            <div class="wy-side-nav-search">
                <a href="https://ubitransports.github.io/gpfs/" class="fa fa-users"> GPFS Reference</a>
            </div>

            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                                            <li class="toctree-l1 current">
                            <a class="reference internal current"
                               href="https://ubitransports.github.io/gpfs/index.html">
                                EN
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="https://ubitransports.github.io/gpfs/fr/reference.html">
                                FR
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="https://ubitransports.github.io/gpfs/changelog.html">
                                Changelog
                            </a>
                        </li>
                                    </ul>
            </div>
            &nbsp;
        </nav>

        <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

                        <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
                <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
                <a href="https://ubitransports.github.io/gpfs/">GPFS Reference</a>
            </nav>


                        <div class="wy-nav-content">
                <div class="rst-content">
                    <div role="main" class="document">
                        <h1 id="passenger_ticketstxt">passenger_tickets.txt</h1>
<p>This file defines the transport tickets associated to users declared in the  <a href="passengers.txt.html">passengers.txt</a>. The accounting concept can be entered in an extension file passenger_tickets.txt</p>
<h2 id="description-of-columns">Description of columns</h2>
<table>
<thead>
<tr>
<th>Field name</th>
<th style="text-align: center;">Mandatory</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ticket_id</td>
<td style="text-align: center;"><strong>Mandatory</strong></td>
<td>Unique identifier of the transport ticket.</td>
</tr>
<tr>
<td>passenger_id</td>
<td style="text-align: center;"><strong>Mandatory</strong></td>
<td>Identifier of the referenced user.</td>
</tr>
<tr>
<td>fare_id</td>
<td style="text-align: center;">Optional</td>
<td>Identifier of the fare linked to this transport ticket.</td>
</tr>
<tr>
<td>ticket_start_on</td>
<td style="text-align: center;">Optional</td>
<td>Start date of validity of the title in format <a href="types.html#Dates">YYYYMMDDhhmmss</a>.</td>
</tr>
<tr>
<td>ticket_end_on</td>
<td style="text-align: center;">Optional</td>
<td>End of validity date of the title in format <a href="types.html#Dates">YYYYMMDDhhmmss</a>.</td>
</tr>
<tr>
<td>restrictions</td>
<td style="text-align: center;">Optional</td>
<td>Restrictions on the use of the title (line, way etc.) in <a href="types.html#JSON">format JSON</a></td>
</tr>
<tr>
<td>unboarding_restrictions</td>
<td style="text-align: center;">Optional</td>
<td>Restrictions of the unboarding in <a href="types.html#JSON">format JSON</a></td>
</tr>
</tbody>
</table>
<h2 id="example">Example:</h2>
<pre><code>ticket_id,passenger_id,fare_id,ticket_start_on,ticket_end_on,restrictions
T0000001,P1,TU1,20160101000000,20160131235959,"[{""line"":{""is"":[""LA"",""LB"",""LC""]}}]"</code></pre>
<h2 id="how-restrictions-work">How Restrictions Work</h2>
<p>If the <code>restrictions</code> and/or fields <code>unboarding_restrictions</code> are filled in, the defined values will replace the restrictions put in place on the fare.  </p>
<p>It is possible to restrict tickets on one or more criteria:</p>
<ul>
<li><code>network</code> - transport network (eg: On the school network)</li>
<li><code>line</code> - line (eg: on line A or B)</li>
<li><code>trip</code> - trip (ex: on trip 107-03A9)</li>
<li><code>stoparea</code> - stoparea (ex: stopeare &quot;Gare SNCF&quot;)</li>
<li><code>stoppoint</code> - physical stop (ex: stoppoint &quot;Gare SNCF&quot;)</li>
<li><code>zone</code> - rate zone (ex: in rate zone &quot;A&quot;)</li>
<li><code>weekday</code> - weekday (ex: Monday to Friday)</li>
<li><code>time</code> - time slot (ex: Between 12 p.m. and 2 p.m.)</li>
<li><code>calendar</code> - calendar (ex: During school holidays)</li>
</ul>
<p>Ticket usage restrictions are managed in <a href="types.html#JSON">JSON format</a>.</p>
<p>A restriction is a JSON array of one or more rules: <code>[REGLE_A, REGLE_B]</code>
Use of the ticket is authorized if at least one of the rules is valid.</p>
<p>A <strong>r√®gle</strong> is a JSON object of one or more criteria cited above:  <code>{CRITERE_A:CONDITION_A, CRITERE_B:CONDITION_B}</code>
The condition is also an object of type <code>{"is":[REFERENCE_A, REFERENCE_B]}</code> or <code>{"isnot":[REFERENCE_A, REFERENCE_B]}</code>.</p>
<h3 id="examples-with-json-restrictions">Examples with JSON restrictions</h3>
<p>Note: For readability reasons these examples in JSON format are not escaped (see above)</p>
<p>Usable on the LA or LB or LC line:</p>
<pre><code>[{"line":{"is":["LA","LB","LC"]}}</code></pre>
<p>Can only be used during school holidays (ref: CAL_SCOLAIRE)</p>
<pre><code>[{"calendar":{"is":["CAL_SCOLAIRE"]}}]</code></pre>
<p>Usable on the school network (ref: RESEAU_SCOLAIRE):</p>
<pre><code>[{"network":{"is":["RESEAU_SCOLAIRE"]}}]</code></pre>
<p>Usable on the school network during the week and on the urban network at the weekend</p>
<pre><code>[{"network":{"is":["RESEAU_SCOLAIRE"]}, "weekday": {"is":["1111100"]}},{"network":{"is":["RESEAU_URBAIN"]}, "weekday": {"is":["0000011"]}}]</code></pre>
<p>Usable on the LA or LB or LC line:</p>
<pre><code>[{"line":{"is":["LA","LB","LC"]}}</code></pre>
<p>Usable everywhere except on TAD line:</p>
<pre><code>[{"line":{"isnot":["TAD"]}}</code></pre>
                    </div>

                    <footer>
                        <hr/>
                                                    <div role="contentinfo">
                                <p>
                                    Find GPFS Reference on <a href="https://github.com/ubitransports/gpfs">GitHub</a>.
                                </p>
                            </div>
                                                GPFS standard is defined by <a href="http://www.ubitransports.com" target="_blank">Ubi Transports</a>.<br/>
                        Built with <a href="http://couscous.io/">Couscous</a> using a <a href="https://github.com/CouscousPHP/Template-ReadTheDocs">theme</a> based on <a href="https://readthedocs.org/">Read the Docs</a>.
                    </footer>

                </div>
            </div>

        </section>

    </div>

    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script src="https://ubitransports.github.io/gpfs/js/theme.js"></script>

    <script>
        $(function() {
            // Syntax highlighting
            hljs.initHighlightingOnLoad();
        });
    </script>

</body>
</html>
